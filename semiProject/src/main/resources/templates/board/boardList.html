<!DOCTYPE html>

<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/css/common/common.css" />
    <link rel="stylesheet" href="/css/board/boardList.css" />
  </head>
  <body>
    <div id="header"></div>
    <th:block th:replace="~{common/header}"></th:block>
    <!-- th:replace="common/header" -->

    <div id="container">
      <div id="title">
        <th:block th:each="board : ${application.boardTypeList}">
          <p
            id="title-text"
            th:if="${board.boardCode == boardCode}"
            th:text="${board.boardName}"
          >
            ê²Œì‹œíŒ ìœ í˜•
          </p>
        </th:block>
      </div>

      <div id="write">
        <!-- ë¡œê·¸ì¸í•œ íšŒì›ë§Œ ê°€ëŠ¥ 
        + jsë§Œë“¤ì–´ì„œ null ì²˜ë¦¬ í•„ìš” 
        -->
        <!-- ê´€ë¦¬ì - ê³µì§€ì‚¬í•­ -->
        <button
          class="write-btn"
          th:if="${session.loginMember != null 
                and (
                  session.loginMember.authority == 2
                  or (
                    session.loginMember.authority == 1
                    and (boardCode == 1 or boardCode == 3 or boardCode == 5)
                  )
                )}"
        >
          ê¸€ì‘ì„±
        </button>
      </div>

      <!-- ê²Œì‹œê¸€ì´ ì—†ì„ ë•Œ ì¡°ê±´ ì¶”ê°€ -->
      <!-- ë´‰ì‚¬ í›„ê¸°ì¼ ë•Œ -->
      <th:block th:if="${boardCode == 3}">
        <div
          th:if="${freeBoardList == null or #lists.isEmpty(freeBoardList)}"
          class="empty-message"
        >
          ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </div>

        <div
          id="volunteerReviewListContent"
          th:unless="${freeBoardList == null or #lists.isEmpty(freeBoardList)}"
        >
          <th:block th:each="board : ${freeBoardList}" th:object="${board}">
            <div id="content-1">
              <div id="content-img">
                <a
                  th:href="@{/board/{boardCode}/{boardNo}(boardCode=${boardCode}, boardNo=*{boardNo}, cp=${pagination.currentPage})}"
                >
                  <img
                    th:src="${board.thumbnailPath != null 
           ? board.thumbnailPath
           : '/images/volunteer.jpeg'}"
                    id="content-img-info"
                  />
                </a>
              </div>

              <div id="content-info">
                <a
                  th:href="@{/board/{boardCode}/{boardNo}(boardCode=${boardCode}, boardNo=*{boardNo}, cp=${pagination.currentPage})}"
                  id="content-title"
                  th:text="*{boardTitle}"
                >
                  ì œëª©
                </a>

                <div>
                  <p id="day-info-text" th:text="*{boardWriteDate}">ì‘ì„±ì¼</p>
                  <p id="view-info-text" th:text="*{readCount}">ì¡°íšŒìˆ˜</p>
                </div>
              </div>
            </div>
          </th:block>
        </div>
      </th:block>

      <!-- ê·¸ ì™¸ ê²Œì‹œíŒ -->
      <th:block th:if="${boardCode != 3}">
        <div
          th:if="${freeBoardList == null or #lists.isEmpty(freeBoardList)}"
          class="empty-message"
        >
          ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </div>

        <div
          id="content"
          th:unless="${freeBoardList == null or #lists.isEmpty(freeBoardList)}"
        >
          <table id="free-board-table">
            <thead id="free-board-head">
              <tr>
                <th>ë²ˆí˜¸</th>
                <th>ì œëª©</th>
                <th>ë‹‰ë„¤ì„</th>
                <th>ì‘ì„±ì¼</th>
                <th>ì¡°íšŒìˆ˜</th>
                <th th:if="${boardCode != 4 && boardCode != 5}">ì¢‹ì•„ìš”</th>
              </tr>
            </thead>

            <tbody id="free-board-body">
              <th:block
                th:each="freeBoard : ${freeBoardList}"
                th:object="${freeBoard}"
              >
                <tr>
                  <td th:text="*{boardNo}">ê²Œì‹œíŒë²ˆí˜¸</td>
                  <td id="board-title">
                    <a
                      th:href="@{/board/{boardCode}/{boardNo}(boardCode=${boardCode}, boardNo=*{boardNo}, cp=${pagination.currentPage})}"
                      th:text="${boardCode == 5 and #strings.equals(freeBoard.boardLock, 'Y') and (session.loginMember == null or (session.loginMember?.memberNo != freeBoard.memberNo and session.loginMember.authority != 2))} ? 'ğŸ”’ ë¹„ë°€ê¸€ì…ë‹ˆë‹¤' : *{boardTitle}"
                      class="board-link"
                      th:data-lock="*{boardLock}"
                      th:data-writer="${memberNo == session.loginMember?.memberNo}"
                    >
                      ê²Œì‹œíŒ ì œëª©
                    </a>
                  </td>
                  <td th:text="*{memberNickname}">ì‘ì„±ì ë‹‰ë„¤ì„</td>
                  <td th:text="*{boardWriteDate}">ì‘ì„±ì¼</td>
                  <td th:text="*{readCount}">ì¡°íšŒìˆ˜</td>
                  <td
                    th:if="${boardCode != 4 && boardCode != 5}"
                    th:text="*{likeCount}"
                  >
                    ì¢‹ì•„ìš”ìˆ˜
                  </td>
                </tr>
              </th:block>
            </tbody>
          </table>
        </div>
      </th:block>

      <!-- í˜ì´ì§€ ë„¤ì´ì…˜ -> ê²€ìƒ‰ì´ ì•„ë‹Œ ê²½ìš° -->
      <div
        id="page"
        th:if="${param.key == null and freeBoardList != null and !#lists.isEmpty(freeBoardList)}"
      >
        <ul>
          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=1)}"
              class="page-btn"
              >&lt;&lt;</a
            >
          </li>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=${pagination.prevPage})}"
              class="page-btn"
              >&lt;</a
            >
          </li>

          <th:block
            th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}"
          >
            <li>
              <a
                th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=${i})}"
                th:text="${i}"
                class="page-btn"
                th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''"
              ></a>
            </li>
          </th:block>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=${pagination.nextPage})}"
              class="page-btn"
              >&gt;</a
            >
          </li>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=${pagination.maxPage})}"
              class="page-btn"
              >&gt;&gt;</a
            >
          </li>
        </ul>
      </div>

      <!-- í˜ì´ì§€ ë„¤ì´ì…˜ -> ê²€ìƒ‰ì¸ ê²½ìš° -->
      <div
        id="page"
        th:if="${param.key != null and freeBoardList != null and !#lists.isEmpty(freeBoardList)}"
        th:object="${pagination}"
      >
        <ul>
          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=1, key=${param.key}, query=${param.query})}"
              class="page-btn"
              >&lt;&lt;</a
            >
          </li>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=*{prevPage}, key=${param.key}, query=${param.query})}"
              class="page-btn"
              >&lt;</a
            >
          </li>

          <th:block
            th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}"
          >
            <li>
              <a
                th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=${i}, key=${param.key}, query=${param.query})}"
                th:text="${i}"
                class="page-btn"
                th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''"
              ></a>
            </li>
          </th:block>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=*{nextPage}, key=${param.key}, query=${param.query})}"
              class="page-btn"
              >&gt;</a
            >
          </li>

          <li>
            <a
              th:href="@{/board/{boardCode}(boardCode=${boardCode}, cp=*{maxPage}, key=${param.key}, query=${param.query})}"
              class="page-btn"
              >&gt;&gt;</a
            >
          </li>
        </ul>
      </div>

      <form
        th:if="${freeBoardList != null and !#lists.isEmpty(freeBoardList)}"
        th:action="@{/board/{boardCode}(boardCode=${boardCode})}"
        id="search"
      >
        <select name="key" id="search-box">
          <option value="t">ì œëª©</option>
          <option value="c">ë‚´ìš©</option>
          <option value="tc">ì œëª© + ë‚´ìš©</option>
          <option value="w">ì‘ì„±ì</option>
        </select>
        <input
          type="text"
          name="query"
          id="search-input"
          placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
        />
        <button id="search-btn">ê²€ìƒ‰</button>
      </form>
    </div>

    <th:block th:replace="~{common/footer}"></th:block>

    <script src="/js/board/boardList.js"></script>
    <script th:inline="javascript">
      const boardCode = /*[[${boardCode}]]*/ "ê²Œì‹œíŒ ì½”ë“œ ë²ˆí˜¸";
      const loginMemberNo =
        /*[[${session.loginMember?.memberNo}]]*/ "ë¡œê·¸ì¸í•œ íšŒì› ë²ˆí˜¸";
      const boardList = /*[[${freeBoardList}]]*/ "ë³´ë“œ ì •ë³´";
      console.log(`ë³´ë“œ ë¦¬ìŠ¤íŠ¸ : ${JSON.stringify(boardList)}`);
      // {"boardNo":2067,"boardTitle":"1234","boardContent":null,"boardWriteDate":"15ë¶„ ì „","boardUpdateDate":null,"readCount":1,"boardDelFl":"\u0000","boardPw":null,"boardLock":"Y","boardCode":0,"memberNo":0,"imgPath":null,"imgRename":null,"memberNickname":"ì œëˆ„ìš”","likeCount":0,"likeCheck":0,"scrapCheck":0,"thumbnailPath":null}
    </script>
  </body>
</html>
