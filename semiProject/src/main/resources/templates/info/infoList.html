<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>정보게시판 | 목록</title>
    <link rel="stylesheet" th:href="@{/css/info/infoList.css}">
</head>
<body>
    <th:block th:replace="~{common/header}"></th:block>

    <main class="info-container">
        <h2 class="page-title">정보게시판</h2>

        <section class="search-container">
            <form th:action="@{/info/listPage}" method="get" id="searchForm">
                <input type="hidden" name="cp" value="1">
                
                <div class="search-row">
                    <span class="search-label">● 봉사지역</span>
                    <select name="schSido">
                        <option value="">전체(시도)</option>
                        <option value="6110000" th:selected="${param.schSido == '6110000'}">서울</option>
                        <option value="6410000" th:selected="${param.schSido == '6410000'}">경기</option>
                        <option value="6260000" th:selected="${param.schSido == '6260000'}">부산</option>
                    </select>
                    <select name="schSign"><option value="">전체(시군구)</option></select>
                    <span class="search-label">● 봉사분야</span>
                    <select name="actRm">
                        <option value="">전체</option>
                        <option value="교육봉사" th:selected="${param.actRm == '교육봉사'}">교육봉사</option>
                        <option value="환경정화" th:selected="${param.actRm == '환경정화'}">환경정화</option>
                        <option value="행정지원" th:selected="${param.actRm == '행정지원'}">행정지원</option>
                        <option value="문화행사" th:selected="${param.actRm == '문화행사'}">문화행사</option>
                    </select>
                </div>
                
                <div class="search-row">
                    <span class="search-label">● 봉사명</span>
                    <input type="text" name="progrmNm" placeholder="봉사명을 입력해주세요" 
                           class="input-full" th:value="${param.progrmNm}">
                    <span class="search-label">● 활동처명</span>
                    <input type="text" name="actPlace" th:value="${param.actPlace}">
                </div>

                <div class="btn-area">
                    <button type="submit" class="btn-search">검색</button>
                    <button type="reset" class="btn-reset">초기화</button>
                    
                    <th:block th:if="${session.loginMember != null and session.loginMember.authority == 2}">
                        <a th:href="@{/info/sync}" class="btn-sync">데이터 새로고침</a>
                    </th:block>
                </div>
            </form>
        </section>

        <section class="info-list-area">
            <div th:unless="${#lists.isEmpty(infoList)}" th:each="info : ${infoList}" class="info-card">
                <div class="card-content">
                    <div class="card-category" th:text="${info.actRm != null ? info.actRm : '봉사활동'}">분류</div>
                    <a th:href="@{/info/detail/{no}(no=${info.infoBoardNo})}" class="card-title" th:text="${info.progrmNm}">제목</a>
                    <div class="card-info-grid">
                        <div class="info-item"><strong>[모집기간]</strong> [[${info.noticeBgnDe}]] ~ [[${info.noticeEndDe}]]</div>
                        <div class="info-item"><strong>[봉사기간]</strong> [[${info.progrmBgnde}]] ~ [[${info.progrmEndde}]]</div>
                        <div class="info-item"><strong>[봉사시간]</strong> [[${info.actBeginTm}]]시 ~ [[${info.actEndTm}]]시</div>
                        <div class="info-item"><strong>[등록기관]</strong> [[${info.nanmmByNm}]]</div>
                        <div class="info-item"><strong>[활동장소]</strong> [[${info.actPlace}]]</div>
                       <div class="info-item">
                        <strong>[인정시간]</strong> 
                        <th:block th:if="${info.actEndTm != null and info.actBeginTm != null}">
                            최대 [[${T(java.lang.Integer).parseInt(info.actEndTm) - T(java.lang.Integer).parseInt(info.actBeginTm)}]]시간
                        </th:block>
                        <th:block th:unless="${info.actEndTm != null and info.actBeginTm != null}">시간협의</th:block>
                    </div>
                    </div>
                </div>
                <div class="status-badge">
                    <div class="d-day-info"><span>상태</span><strong class="highlight">D-Day</strong></div>
                    <div class="status-text">모집중</div>
                </div>
            </div>

            <div th:if="${#lists.isEmpty(infoList)}" class="no-data">조회된 봉사 정보가 없습니다.</div>

            <div id="pagination-box" th:if="${not #lists.isEmpty(infoList) and pagination != null}">
                <ul>
                    <li><a th:href="@{/info/listPage(cp=${pagination.prevPage}, progrmNm=${param.progrmNm}, actPlace=${param.actPlace}, schSido=${param.schSido}, actRm=${param.actRm})}" class="page-arrow">&lt;</a></li>
                    
                    <li th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}">
                        <a th:if="${i == pagination.currentPage}" class="page-num active" th:text="${i}">1</a>
                        <a th:unless="${i == pagination.currentPage}" 
                           th:href="@{/info/listPage(cp=${i}, progrmNm=${param.progrmNm}, actPlace=${param.actPlace}, schSido=${param.schSido}, actRm=${param.actRm})}" 
                           class="page-num" th:text="${i}">2</a>
                    </li>
                    
                    <li><a th:href="@{/info/listPage(cp=${pagination.nextPage}, progrmNm=${param.progrmNm}, actPlace=${param.actPlace}, schSido=${param.schSido}, actRm=${param.actRm})}" class="page-arrow">&gt;</a></li>
                </ul>
            </div>
        </section>
    </main>

    <th:block th:replace="~{common/header}"></th:block>
    <script th:src="@{/js/info/infoList.js}"></script>
</body>
</html>