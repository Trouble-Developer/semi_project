<section>

  <!-- ================= 제목 + 글작성 버튼 ================= -->
  <div class="admin-title-wrap">
    <h1 class="admin-page-title">공지사항</h1>

    <!-- 관리자 전용 공지사항 작성 버튼 -->
    <!-- 기존 board 글쓰기 기능 재사용 (boardCode = 4) -->
    <a th:href="@{/editBoard/{boardCode}/insert(boardCode=4)}" class="btn-write">
      글작성
    </a>
  </div>

  <hr>

  <!-- ================= 공지사항 목록 테이블 ================= -->
  <table class="admin-table">
    <thead>
      <tr>
        <th>번호</th>
        <th>제목</th>
        <th>작성자</th>
        <th>작성일</th>
        <th>조회수</th>
        <th>관리</th>
      </tr>
    </thead>

    <tbody>
      <!-- 공지사항 목록 -->
      <tr th:each="notice : ${freeBoardList}">
        <td th:text="${notice.boardNo}">1</td>

        <!-- 기존 공지사항 상세 페이지로 이동 (board 재사용) -->
        <td>
            <a th:href="@{/board/4/{boardNo}(
                  boardNo=${notice.boardNo},
                  from='adminNotice',
                  cp=${pagination.currentPage})}"
                th:text="${notice.boardTitle}">
                공지사항 제목
            </a>
        </td>

        <td th:text="${notice.memberNickname}">관리자</td>
        <td th:text="${notice.boardWriteDate}">2025-12-24</td>
        <td th:text="${notice.readCount}">0</td>

        <!-- 관리자 전용 삭제 버튼 -->
        <td>
          <!-- 삭제된 글이 아닌 경우 -->
          <form th:if="${notice.boardDelFl == 'N'}"
                th:action="@{/admin/notice/updateStatus}"
                method="post"
                onsubmit="return confirm('정말 삭제하시겠습니까?');">

            <input type="hidden" name="boardNo" th:value="${notice.boardNo}">
            <input type="hidden" name="boardDelFl" value="Y">

            <button type="submit" class="btn-outline danger">
              삭제
            </button>
          </form>

          <!-- 삭제된 글인 경우 -->
          <form th:if="${notice.boardDelFl == 'Y'}"
                th:action="@{/admin/notice/updateStatus}"
                method="post"
                onsubmit="return confirm('이 공지사항을 복구하시겠습니까?');">

            <input type="hidden" name="boardNo" th:value="${notice.boardNo}">
            <input type="hidden" name="boardDelFl" value="N">

            <button type="submit" class="btn-outline restore-btn">
              복구
            </button>
          </form>
        </td>
      </tr>

      <!-- 공지사항이 없을 때 -->
      <tr th:if="${#lists.isEmpty(freeBoardList)}">
        <td colspan="6">등록된 공지사항이 없습니다.</td>
      </tr>
    </tbody>
  </table>

  <!-- ================= 페이지네이션 (검색 X) ================= -->
  <div
    id="page"
    th:if="${param.key == null and freeBoardList != null and !#lists.isEmpty(freeBoardList)}"
  >
    <ul>
      <li>
        <a th:href="@{/admin/notice(cp=1)}" class="page-btn">&lt;&lt;</a>
      </li>

      <li>
        <a th:href="@{/admin/notice(cp=${pagination.prevPage})}"
          class="page-btn">&lt;</a>
      </li>

      <th:block th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}">
        <li>
          <a th:href="@{/admin/notice(cp=${i})}"
            th:text="${i}"
            class="page-btn"
            th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''">
          </a>
        </li>
      </th:block>

      <li>
        <a th:href="@{/admin/notice(cp=${pagination.nextPage})}"
          class="page-btn">&gt;</a>
      </li>

      <li>
        <a th:href="@{/admin/notice(cp=${pagination.maxPage})}"
          class="page-btn">&gt;&gt;</a>
      </li>
    </ul>
  </div>

  <!-- ================= 페이지네이션 (검색 O) ================= -->
  <div
    id="page"
    th:if="${param.key != null and freeBoardList != null and !#lists.isEmpty(freeBoardList)}"
    th:object="${pagination}"
  >
    <ul>
      <li>
        <a th:href="@{/admin/notice(cp=1, key=${param.key}, query=${param.query})}"
          class="page-btn">&lt;&lt;</a>
      </li>

      <li>
        <a th:href="@{/admin/notice(cp=*{prevPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&lt;</a>
      </li>

      <th:block th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}">
        <li>
          <a th:href="@{/admin/notice(cp=${i}, key=${param.key}, query=${param.query})}"
            th:text="${i}"
            class="page-btn"
            th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''">
          </a>
        </li>
      </th:block>

      <li>
        <a th:href="@{/admin/notice(cp=*{nextPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&gt;</a>
      </li>

      <li>
        <a th:href="@{/admin/notice(cp=*{maxPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&gt;&gt;</a>
      </li>
    </ul>
  </div>

  <!-- ================= 검색 ================= -->
  <div class="search-area">
    <form action="/admin/notice" method="get">
      <select name="key" id="search-box">
        <option value="t"
                th:selected="${param.key == 't'}">제목</option>
        <option value="c"
                th:selected="${param.key == 'c'}">내용</option>
        <option value="tc"
                th:selected="${param.key == 'tc'}">제목 + 내용</option>
      </select>

      <input type="text"
             name="query"
             id="search-input"
             th:value="${param.query}"
             placeholder="검색어를 입력해주세요">

      <button type="submit"
              id="search-btn">
        검색
      </button>
    </form>
  </div>

</section>
