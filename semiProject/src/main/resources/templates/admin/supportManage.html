<section class="admin-main">

  <!-- ===============================
       페이지 제목
       =============================== -->
  <h1 class="admin-page-title">고객지원</h1>
  <hr>

  <!-- ===============================
       고객지원 게시글 테이블
       =============================== -->
  <table class="admin-table">
    <thead>
      <tr>
        <th>번호</th>
        <th>제목</th>
        <th>닉네임</th>
        <th>작성일</th>
        <th>게시글 삭제</th>
      </tr>
    </thead>

    <tbody>
      <!-- ===============================
           고객지원 게시글 목록
           supportList : Controller에서 내려준 게시글 목록
           =============================== -->
      <tr th:each="s : ${supportList}">
        <!-- 게시글 번호 -->
        <td th:text="${s.boardNo}">1</td>

        <!-- 게시글 제목 (상세 페이지 이동) -->
        <td>
          <a th:href="@{/board/5/{boardNo}(boardNo=${s.boardNo}, cp=${pagination.currentPage})}"
             th:text="${s.boardTitle}">
            제목
          </a>
        </td>

        <!-- 작성자 닉네임 -->
        <td th:text="${s.memberNickname}">닉네임</td>

        <!-- 작성일 -->
        <td th:text="${s.boardWriteDate}">2025-12-15</td>

        <!-- ===============================
             삭제 / 복구 버튼 영역
             ✔ 하나의 form으로 삭제/복구를 모두 처리
             ✔ boardDelFl 값을 hidden input으로 넘겨서 상태 토글
             =============================== -->
        <td>
          <form th:action="@{/admin/support/updateStatus}"
                method="post"
                onsubmit="return confirm('정말 변경하시겠습니까?');">

            <input type="hidden" name="boardNo" th:value="${s.boardNo}">

            <!-- 현재가 Y(삭제)면 N(복구)로, 현재가 N이면 Y로 -->
            <input type="hidden" name="boardDelFl"
                  th:value="${s.boardDelFl == 'Y' ? 'N' : 'Y'}">

            <button type="submit"
                    class="btn-outline"
                    th:text="${s.boardDelFl == 'Y' ? '복구' : '삭제'}"
                    th:classappend="${s.boardDelFl == 'Y'} ? ' restore-btn' : ' danger'"> <!-- 삭제는 주황색, 복구는 초록색 css를 받도록 만듬. -->
            </button>
          </form>
        </td>
      </tr>

      <!-- ===============================
           게시글이 하나도 없을 경우
           =============================== -->
      <tr th:if="${#lists.isEmpty(supportList)}">
        <td colspan="5">고객지원 게시글이 없습니다.</td>
      </tr>
    </tbody>
  </table>

  <!-- ===============================
       페이지네이션 (검색 X)
       =============================== -->
  <div id="page" th:unless="${param.key}">
    <ul>
      <li>
        <a th:href="@{/admin/support(cp=1)}" class="page-btn">&lt;&lt;</a>
      </li>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.prevPage})}"
           class="page-btn">&lt;</a>
      </li>

      <th:block th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage)}">
        <li>
          <a th:href="@{/admin/support(cp=${i})}"
             th:text="${i}"
             class="page-btn"
             th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''">
          </a>
        </li>
      </th:block>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.nextPage})}"
           class="page-btn">&gt;</a>
      </li>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.maxPage})}"
           class="page-btn">&gt;&gt;</a>
      </li>
    </ul>
  </div>

  <!-- ===============================
       페이지네이션 (검색 O)
       =============================== -->
  <div id="page" th:if="${param.key}">
    <ul>
      <li>
        <a th:href="@{/admin/support(cp=1, key=${param.key}, query=${param.query})}"
          class="page-btn">&lt;&lt;</a>
      </li>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.prevPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&lt;</a>
      </li>

      <th:block th:each="i : ${#numbers.sequence(
          pagination.startPage,
          pagination.endPage)}">
        <li>
          <a th:href="@{/admin/support(cp=${i}, key=${param.key}, query=${param.query})}"
            th:text="${i}"
            class="page-btn"
            th:classappend="${i == pagination.currentPage} ? ' curr-page' : ''">
          </a>
        </li>
      </th:block>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.nextPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&gt;</a>
      </li>

      <li>
        <a th:href="@{/admin/support(cp=${pagination.maxPage}, key=${param.key}, query=${param.query})}"
          class="page-btn">&gt;&gt;</a>
      </li>
    </ul>
  </div>

  <!-- ===============================
       검색창
       =============================== -->
  <div class="search-area">
    <form action="/admin/support" method="get">
      <select name="key" id="search-box">
        <option value="title" th:selected="${param.key == 'title'}">제목</option>
        <option value="content" th:selected="${param.key == 'content'}">내용</option>
        <option value="writer" th:selected="${param.key == 'writer'}">작성자</option>
      </select>

      <input type="text"
             name="query"
             id="search-input"
             th:value="${param.query}"
             placeholder="검색어를 입력해주세요">

      <button type="submit" id="search-btn">검색</button>
    </form>
  </div>

</section>